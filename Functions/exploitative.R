exEq <- function(r,alpha_x,beta,mu,gamma,nu,m_y,m_z,alpha_y,alpha_yz,alpha_z,alpha_zy) {
  x <- ((alpha_z*alpha_zy*gamma - alpha_z*beta)*m_y + (alpha_y*alpha_yz*beta - alpha_y*gamma)*m_z + (alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_y*alpha_z)*r)/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu)
  y <- -(alpha_x*alpha_y*alpha_yz*m_z + beta*gamma*m_z*mu - gamma^2*m_y*nu - alpha_x*alpha_z*m_y - (alpha_y*alpha_yz*gamma*nu - alpha_z*beta*mu)*r)/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu)
  z <- -(alpha_x*alpha_z*alpha_zy*m_y - beta^2*m_z*mu + beta*gamma*m_y*nu - alpha_x*alpha_y*m_z - (alpha_z*alpha_zy*beta*mu - alpha_y*gamma*nu)*r)/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu)
  return(c(x = x, y = y, z = z))
}

exSt <- function(r,alpha_x,beta,mu,gamma,nu,m_y,m_z,alpha_y,alpha_yz,alpha_z,alpha_zy) {
  # Jacobian at equilibrium
  J <- c(
    -2*((alpha_z*alpha_zy*gamma - alpha_z*beta)*m_y + (alpha_y*alpha_yz*beta - alpha_y*gamma)*m_z + (alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_y*alpha_z)*r)*alpha_x/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu) + (alpha_x*alpha_y*alpha_yz*m_z + beta*gamma*m_z*mu - gamma^2*m_y*nu - alpha_x*alpha_z*m_y - (alpha_y*alpha_yz*gamma*nu - alpha_z*beta*mu)*r)*beta/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu) + (alpha_x*alpha_z*alpha_zy*m_y - beta^2*m_z*mu + beta*gamma*m_y*nu - alpha_x*alpha_y*m_z - (alpha_z*alpha_zy*beta*mu - alpha_y*gamma*nu)*r)*gamma/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy -alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu) + r, # xx
    -(alpha_x*alpha_y*alpha_yz*m_z + beta*gamma*m_z*mu - gamma^2*m_y*nu - alpha_x*alpha_z*m_y - (alpha_y*alpha_yz*gamma*nu - alpha_z*beta*mu)*r)*beta*mu/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu), # xy
    -(alpha_x*alpha_z*alpha_zy*m_y - beta^2*m_z*mu + beta*gamma*m_y*nu - alpha_x*alpha_y*m_z - (alpha_z*alpha_zy*beta*mu - alpha_y*gamma*nu)*r)*gamma*nu/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu), # xz
    -((alpha_z*alpha_zy*gamma - alpha_z*beta)*m_y + (alpha_y*alpha_yz*beta - alpha_y*gamma)*m_z + (alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_y*alpha_z)*r)*beta/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu), # yx
    (alpha_x*alpha_z*alpha_zy*m_y - beta^2*m_z*mu + beta*gamma*m_y*nu - alpha_x*alpha_y*m_z - (alpha_z*alpha_zy*beta*mu - alpha_y*gamma*nu)*r)*alpha_y*alpha_yz/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu) + ((alpha_z*alpha_zy*gamma - alpha_z*beta)*m_y + (alpha_y*alpha_yz*beta - alpha_y*gamma)*m_z + (alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_y*alpha_z)*r)*beta*mu/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu) + 2*(alpha_x*alpha_y*alpha_yz*m_z + beta*gamma*m_z*mu - gamma^2*m_y*nu - alpha_x*alpha_z*m_y - (alpha_y*alpha_yz*gamma*nu - alpha_z*beta*mu)*r)*alpha_y/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu) - m_y, # yy
    (alpha_x*alpha_z*alpha_zy*m_y - beta^2*m_z*mu + beta*gamma*m_y*nu - alpha_x*alpha_y*m_z - (alpha_z*alpha_zy*beta*mu - alpha_y*gamma*nu)*r)*alpha_z*alpha_zy/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu), # yz
    -((alpha_z*alpha_zy*gamma - alpha_z*beta)*m_y + (alpha_y*alpha_yz*beta - alpha_y*gamma)*m_z + (alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_y*alpha_z)*r)*gamma/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu), # zx
    (alpha_x*alpha_y*alpha_yz*m_z + beta*gamma*m_z*mu - gamma^2*m_y*nu - alpha_x*alpha_z*m_y - (alpha_y*alpha_yz*gamma*nu - alpha_z*beta*mu)*r)*alpha_y*alpha_yz/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu), # zy
    (alpha_x*alpha_y*alpha_yz*m_z + beta*gamma*m_z*mu - gamma^2*m_y*nu - alpha_x*alpha_z*m_y - (alpha_y*alpha_yz*gamma*nu - alpha_z*beta*mu)*r)*alpha_z*alpha_zy/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu) + ((alpha_z*alpha_zy*gamma - alpha_z*beta)*m_y + (alpha_y*alpha_yz*beta - alpha_y*gamma)*m_z + (alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_y*alpha_z)*r)*gamma*nu/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu) + 2*(alpha_x*alpha_z*alpha_zy*m_y - beta^2*m_z*mu + beta*gamma*m_y*nu - alpha_x*alpha_y*m_z - (alpha_z*alpha_zy*beta*mu - alpha_y*gamma*nu)*r)*alpha_z/(alpha_x*alpha_y*alpha_yz*alpha_z*alpha_zy - alpha_x*alpha_y*alpha_z + (alpha_z*alpha_zy*beta*gamma - alpha_z*beta^2)*mu + (alpha_y*alpha_yz*beta*gamma - alpha_y*gamma^2)*nu) - m_z) # zz

  # Jacobian matrix
  J <- matrix(J, nrow = 3)

  # Stability
  S <- as.numeric(eigen(J)$values[1])

  # Return
  return(S)
}

exIneq <- function(r,alpha_x,beta,mu,gamma,nu,m_y,m_z,alpha_y,alpha_yz,alpha_z,alpha_zy) {
  # Inequality expressions
  inequalities <- list(
    expression(),
    expression(exEq(r,alpha_x,beta,mu,gamma,nu,m_y,m_z,alpha_y,alpha_yz,alpha_z,alpha_zy)[1] < 1),
    expression(exEq(r,alpha_x,beta,mu,gamma,nu,m_y,m_z,alpha_y,alpha_yz,alpha_z,alpha_zy)[2] < 1),
    expression(exEq(r,alpha_x,beta,mu,gamma,nu,m_y,m_z,alpha_y,alpha_yz,alpha_z,alpha_zy)[3] < 1)
  )

  # Eval function
  lapply(inequalities, eval, envir = environment()) %>% unlist() %>% any()
}
